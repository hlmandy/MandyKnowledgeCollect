[TOC]

##### 参考资料

**1. 随机森林基础知识**

先看 2021_An Introduction To Statistical Learning with R_2nd_2021_stanford教材.pdf

再看 西瓜书

> ref: [1]Breiman, “Random Forests”, Machine Learning, 45(1), 5-32, 2001.

**2. imbalanced data**

ref: Chen C, Liaw A, Breiman L (2004) Using random forest to learn imbalanced data. Working paper No. 666, University of California, Berkeley, CA.

> 这是 2023_TS_Using Machine Learning to Include Planners’ Preferences in Railway Crew Scheduling Optimization 引用的



## 随机森林基础知识

最简单是bagging tree，是随机抽样本，bootstrap，这样大概会抽2/3的数据，留下1/3的数据作为out-of-bag validation。

然后对于这一组树的估计结果取平均，取平均的目的是为了降低variance。



随机森林是在 bagging tree 的基础上，对feature也做了selection。如果原来一共有 $p$ 个feature，那么就选择 $m=\sqrt{p}$ 个feature （随机选择）。这样做的目的是为了避免有些特征特别重要，导致树都很相似，相关性过高。如果相关性过高的话，那么取平均也不会降低variance。



在ref: [1]Breiman, “Random Forests”, Machine Learning, 45(1), 5-32, 2001. 中提到

简单的随机森林不剪枝



## imbalanced 随机森林

ref: Chen C, Liaw A, Breiman L (2004) Using random forest to learn imbalanced data. Working paper No. 666, University of California, Berkeley, CA.

> 这篇是个working paper，的确写的不怎么样

这篇里面提到两个方法，一个是抽样，一个是 weighted random forest。weighted random forest 是这么做的：

1. 在每个node做split的时候，用weighted gini
2. 在每个node做判断的时候，用weighted majority



## python

### sklearn

> https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html
>
> The “balanced” mode uses the values of y to automatically adjust weights inversely proportional to class frequencies in the input data as `n_samples / (n_classes * np.bincount(y))`
>
> sklearn 参考的：[1]Breiman, “Random Forests”, Machine Learning, 45(1), 5-32, 2001.



#### 参数解释

**超参：**

| parameters        | 含义                                                     | default value                                        |
| ----------------- | -------------------------------------------------------- | ---------------------------------------------------- |
| n_estimators      | 森林中树的数量                                           | 100                                                  |
| max_depth         | 每棵树的深度                                             | None，表示树长到不能再长，如到达min_sample_split限制 |
| min_samples_split | split的最小sample数量                                    | 2                                                    |
| min_samples_leaf  | leaf允许的最少sample数量                                 | 1                                                    |
| random_state      | 用来控制bootstrapping & feature sampling 的 random state |                                                      |
| class_weight      | 'balance'就表示是input data类别频次的倒数                |                                                      |









