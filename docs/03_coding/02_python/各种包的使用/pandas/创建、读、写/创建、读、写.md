# 创建、读、写

## 目录

-   [1. 创建、读、写](#1-创建读写)
    -   [1.1 创建](#11-创建)
    -   [1.2 读](#12-读)
        -   [1.2.1 从csv/excel读取](#121-从csvexcel读取)
        -   [1.2.2 从数据库读取](#122-从数据库读取)
    -   [1.3 写](#13-写)
        -   [写入excel，多个sheet](#写入excel多个sheet)

**Sample Code**

**读入：**

```python
```

**导出：**

```python
## --- 设置时间格式
df.to_csv(fname,index=False,date_format="%Y/%m/%d %H:%M")
```

# 1. 创建、读、写

## 1.1 创建

```python
d = {'col1': [1, 2], 'col2': [3, 4]}
df = pd.DataFrame(data=d)
```

## 1.2 读

### 1.2.1 从csv/excel读取

```python
apt_list = pd.read_csv("./QW机场.csv",encoding="utf-8")
flight_sch = pd.read_excel("../raw_data_210428/实时航班计划表6.7-6.13.xlsx",dtype={'班期':str})

## other dtypes: datetime,str,float...
## csv 没有datetime，没有为read_csv设置datetime dtype，因为csv文件只能包含字符串，整数和浮点数。

##跳过第一行
pd.read_excel("各基地间航材陆运时间表(1)(1).xlsx",skiprows=[0])

## 第一行不是column 名称，额外指定column名称
pd.read_csv(_fdl_fname, sep='|', header= None,names=_fdl_cols)

```

### 1.2.2 从数据库读取

[pandas.read\_sql\_query](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_sql_query.html "pandas.read_sql_query")

> pandas.read\_sql\_query(sql, con, index\_col=None, coerce\_float=True, params=None, parse\_dates=None, chunksize=None, dtype=None)

```python
pd.read_sql_query
```

## 1.3 写

```python
flight_sch.to_csv('flight_schedule.csv',encoding='gbk',index=False)
flight_sch.to_csv('flights.txt',encoding='gbk',index=False,sep='\t')
```

### 写入excel，多个sheet

```python
#创建一个输出文件
writer = pd.ExcelWriter('E:/Test/test.xlsx')
 
data = pd.read_table('E:/Test/test1.csv',sep=',',encoding='GBK')
data.to_excel(writer,'data',index=False)
 
base = pd.read_excel('E:/Test/test2.xlsx','Sheet1')
base.to_excel(writer,'base',index=False)
  
base1 = pd.read_csv('E:/Test/test3.csv')
base1.to_excel(writer,'base1',index=False)
 
#保存
writer.save()
————————————————
版权声明：本文为CSDN博主「范儿札记」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/Fan20190515/article/details/119885830
```

[pandas to\_csv()写入函数参数详解\_副本](pandas%20to_csv()写入函数参数详解_副本.md to_csv()写入函数参数详解_副本/pandas to_csv()写入函数参数详解_副本.md> "pandas to_csv()写入函数参数详解_副本")

[pandas to\_csv:在将pandas写入csv时抑制csv文件中的科学记数法 | 经验摘录\_副本](pandas%20to_csv-在将pandas写入csv时抑制csv文件中的科学记数法%20-%20经验摘录_.md to_csv-在将pandas写入csv时抑制/pandas to_csv-在将pandas写入csv时抑制csv文件中的科学记数法 - 经验摘录_.md> "pandas to_csv:在将pandas写入csv时抑制csv文件中的科学记数法 | 经验摘录_副本")
